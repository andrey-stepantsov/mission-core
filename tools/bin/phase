#!/bin/bash
set -e

# Check for role argument
if [ -z "$1" ]; then
    echo "Usage: $0 <role>"
    echo "Available roles are files in prompts/system/*_rules.md"
    exit 1
fi

ROLE=$1
SOURCE_FILE="prompts/system/${ROLE}_rules.md"
DEST_FILE="CONVENTIONS.md"

# Check if source file exists
if [ ! -f "$SOURCE_FILE" ]; then
    echo "Error: Role '$ROLE' not found. No rules file at $SOURCE_FILE"
    exit 1
fi

# Copy the rules file
cp "$SOURCE_FILE" "$DEST_FILE"

# Output success message
echo "Switched to ${ROLE} mode. Please notify Aider."
